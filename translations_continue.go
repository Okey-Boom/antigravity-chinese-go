package main

import (
	"strings"
)

// ContinueTranslations Continue 扩展的翻译规则
// 目标文件: C:\Users\{用户名}\.antigravity\extensions\continue.continue-{版本号}-win32-x64\gui\assets\index.js

// quotedTranslationsContinue 带引号的翻译规则（会自动匹配 "key", 'key', `key` 三种格式）
var quotedTranslationsContinue = map[string]string{
	"API Key":                        "API 密钥",
	"Error":                          "错误",
	"Unknown error":                  "未知错误",
	"Home":                           "首页",
	"Delete":                         "删除",
	"Date":                           "日期",
	"Security Policy Violation":      "违反安全策略",
	"Command Disabled":               "命令已禁用",
	"Invalid Tool Call":              "无效的工具调用",
	"Tool Call Error":                "工具调用错误",
	"Premature Close":                "过早关闭",
	"View error output":              "查看错误输出",
	"Auto-formatting Applied":        "已应用自动格式化",
	"Editor auto-formatting changes": "编辑器自动格式化更改",
	"Edit Success":                   "编辑成功",
	"Edit Failed":                    "编辑失败",
	"Apply Error":                    "应用错误",
	"Failed to apply changes":        "应用更改失败",
	"Tool Call Failed":               "工具调用失败",
	"Starter credits usage":          "初始额度使用情况",
	"Refresh credit usage":           "刷新额度使用",
	"Hide starter credits usage":     "隐藏初始额度使用",
	"View errors":                    "查看错误",
	"Configs":                        "配置",
	"Organizations":                  "组织",
	"Log in":                         "登录",
	"View configuration errors":      "查看配置错误",
	"View remaining starter credits": "查看剩余初始额度",
	"Configure rules":                "配置规则",
	"Configure tools":                "配置工具",
	"Configure models":               "配置模型",
	"Select Config":                  "选择配置",
	"Move to background":             "移至后台运行",
	"of context filled.":             "上下文空间已被占用。",
	"Loading Sessions...":            "正在加载会话...",
	"Default agent system message":   "默认 Agent 系统提示词",
	"Organizations are only available with cloud accounts. Sign in to manage organizations.":       "组织功能仅适用于云端账号。请登录以管理组织。",
	"Allows indexing of your codebase for search and context understanding.":                       "允许对您的代码库建立索引，以支持搜索及上下文理解功能。",
	"Note that indexing can consume significant system resources, especially on larger codebases.": "请注意：建立索引可能会消耗大量系统资源，尤其是在代码库规模较大时。",
	"Indexing has been deprecated":                             "索引功能已被弃用",
	"make your agent aware of your codebase and documentation": "让您的 Agent 了解您的代码库与文档",
	"Reject":                          "拒绝",
	"Accept":                          "接受",
	"Generating":                      "生成中",
	"Applying":                        "正在应用",
	"Tool Call Rejected":              "工具调用已拒绝",
	"User skipped the tool call":      "用户跳过了工具调用",
	"Stop":                            "停止",
	"Retry":                           "重试",
	"Edit":                            "编辑",
	"Generating conversation summary": "正在生成对话摘要",
	"Generating diagram...":           "正在生成图表...",
	"Delete summary":                  "删除摘要",
	"Helpful":                         "有帮助",
	"Unhelpful":                       "无帮助",
	"Create Rule Block":               "创建规则块",
	"An error occurred":               "发生错误",
	"Unknown error occurred":          "发生未知错误",
	"Always":                          "始终",
	"Agent Requested":                 "代理请求",
	"Manual":                          "手动",
	"Description":                     "描述",
	"Description of the task this rule is helpful for...": "描述此规则适用的任务...",
	"Your rule content...":                                "您的规则内容...",
	"Back":                                                "返回",
	"Continue":                                            "继续",
	"Always Applied":                                      "始终应用",
	"Auto attached":                                       "自动附加",
	"Describe your rule...":                               "描述您的规则...",
	"Cancel":                                              "取消",
	"Copy":                                                "复制",
	"Summarize conversation to reduce context length": "总结对话以减少上下文长度",
	"Compact conversation":                            "精简对话",
	"Generate rule":                                   "生成规则",
	"Continue generation":                             "继续生成",
	"Chat 1":                                          "聊天 1",
	"Edit output":                                     "编辑输出",
	"Name":                                            "名称",
	"Email":                                           "邮箱",
	"Submit":                                          "提交",
	"Help":                                            "帮助",
	"View":                                            "查看",
	"Hide":                                            "隐藏",
	"Restart":                                         "重启",
	"User Input":                                      "用户输入",
	"Models":                                          "模型",
	"Add Chat model":                                  "添加聊天模型",
	"Chat":                                            "聊天",
	"All tools disabled":                              "所有工具已禁用",
	"Read-only/MCP tools available":                   "只读/MCP 工具可用",
	"All tools available":                             "所有工具可用",
	"Background mode cannot be used with local agents.": "后台模式不能与本地代理一起使用。",
	"Oldest messages are being removed.":                "最旧的消息正在被移除。",
	"Start a new session":                               "开始新会话",
	"Select Mode":                                       "选择模式",
	"Select Model":                                      "选择模型",
	"Attach Image":                                      "附加图片",
	"Attach Context":                                    "附加上下文",
	"Send (⏎)":                                          "发送 (⏎)",
	"Write something …":                                 "写点什么...",
	"Loading...":                                        "加载中...",
	"Please wait while items are being loaded":          "请稍候，正在加载项目",
	"Open in new tab":                                   "在新标签页打开",
	"Add more context providers":                        "添加更多上下文提供者",
	"Explore prompts":                                   "探索提示",
	"Ask a follow-up":                                   "请进一步提问",
	"Save":                                              "保存",
	"Confirm":                                           "确认",
	"Initializing":                                      "正在初始化",
	"Rebuild codebase index":                            "重建代码库索引",
	"Close":                                             "关闭",
	"View detailed docs information":                    "查看详细文档信息",
	"Documentation":                                     "文档",
	"Add documentation":                                 "添加文档",
	"Enable indexing":                                   "启用索引",
	"Indexing":                                          "索引中",
	"Configure":                                         "配置",
	"Add model":                                         "添加模型",
	"Learn more":                                        "了解更多",
	"Autocomplete":                                      "自动补全",
	"Additional model roles":                            "其他模型角色",
	"Apply, Embed, Rerank":                              "应用、嵌入、重排序",
	"Apply":                                             "应用",
	"Used to apply generated codeblocks to files": "用于将生成的代码块应用到文件",
	"Embed": "嵌入",
	"Used to generate and query embeddings for the @codebase and @docs context providers": "用于为 @codebase 和 @docs 上下文提供者生成和查询嵌入",
	"Rerank": "重排序",
	"Used for reranking results from the @codebase and @docs context providers": "用于对 @codebase 和 @docs 上下文提供者的结果进行重排序",
	"Add organization":   "添加组织",
	"ex: api-guidelines": "例如：api-guidelines",
	"Create":             "创建",
	"Delete Rule":        "删除规则",
	"Are you sure you want to delete this rule file?": "确定要删除此规则文件吗？",
	"Expand":                               "展开",
	"Prompts":                              "提示",
	"Add prompt":                           "添加提示",
	"Current workspace":                    "当前工作区",
	"Global":                               "全局",
	"Rules":                                "规则",
	"Add rules":                            "添加规则",
	"Active":                               "激活",
	"Inactive":                             "未激活",
	"Disconnect":                           "断开",
	"Tools":                                "工具",
	"Resources":                            "资源",
	"Manage MCP servers and tool policies": "管理 MCP 服务器和工具策略",
	"Built-in Tools":                       "内置工具",
	"MCP Servers":                          "MCP 服务器",
	"Add MCP server":                       "添加 MCP 服务器",
	"No MCP servers configured. Click the + button to add your first server.": "未配置 MCP 服务器。点击 + 按钮添加您的第一个服务器。",
	"Use Static Contextualization":                                            "使用静态上下文",
	"User Settings":                                                           "用户设置",
	"Show Session Tabs":                                                       "显示会话标签页",
	"Displays tabs above the chat as an alternative way to organize and access your sessions.": "在聊天上方显示选项卡，作为组织和访问会话的另一种方式。",
	"Wrap Codeblocks": "自动换行代码块",
	"Wraps long lines in code blocks instead of showing horizontal scroll.": "在代码块中自动换行长行，而不是显示水平滚动。",
	"Show Chat Scrollbar":                     "显示聊天滚动条",
	"Enables a scrollbar in the chat window.": "在聊天窗口中启用滚动条。",
	"Text-to-Speech Output":                   "文本转语音输出",
	"Reads LLM responses aloud with TTS.":     "使用 TTS 朗读 LLM 回复。",
	"Enable Session Titles":                   "启用会话标题",
	"Generates summary titles for each chat session after the first message, using the current Chat model.": "在第一条消息后，使用当前聊天模型为每个聊天会话生成摘要标题。",
	"Format Markdown":                                  "格式化 Markdown",
	"If off, shows responses as raw text.":             "如果关闭，则将回复显示为原始文本。",
	"Telemetry":                                        "遥测",
	"Allow Anonymous Telemetry":                        "允许匿名遥测",
	"Allows Continue to send anonymous telemetry.":     "允许 Continue 发送匿名遥测数据。",
	"Appearance":                                       "外观",
	"Font Size":                                        "字体大小",
	"Specifies base font size for UI elements.":        "指定 UI 元素的基准字体大小。",
	"Multiline Autocompletions":                        "多行自动补全",
	"Controls multiline completions for autocomplete.": "控制自动补全的多行补全。",
	"Auto":                      "自动",
	"Never":                     "从不",
	"Autocomplete Timeout (ms)": "自动补全超时 (ms)",
	"Maximum time in milliseconds for autocomplete request/retrieval.":                "自动补全请求/检索的最长时间（以毫秒为单位）。",
	"Autocomplete Debounce (ms)":                                                      "自动补全防抖 (ms)",
	"Minimum time in milliseconds to trigger an autocomplete request after a change.": "更改后触发自动补全请求的最短时间（以毫秒为单位）。",
	"Disable autocomplete in files":                                                   "在文件中禁用自动补全",
	"List of comma-separated glob pattern to disable autocomplete in matching files.": "禁用匹配文件中的自动补全的逗号分隔 glob 模式列表。",
	"Experimental":                "实验性功能",
	"Show Experimental Settings":  "显示实验性设置",
	"Add Current File by Default": "默认添加当前文件",
	" the currently open file is added as context in every new conversation.": " 当前打开的文件将作为上下文添加到每个新对话中。",
	"Enable experimental tools": "启用实验性工具",
	" enables access to experimental tools that are still in development.":                          " 启用对仍在开发中的实验性工具的访问。",
	"Only use system message tools":                                                                 "仅使用系统消息工具",
	" Continue will not attempt to use native tool calling and will only use system message tools.": " Continue 将不会尝试使用本机工具调用，而仅使用系统消息工具。",
	"@Codebase: use tool calling only":                                                              "@Codebase：仅使用工具调用",
	" @codebase context provider will only use tool calling for code retrieval.":                    " @codebase 上下文提供者将仅使用工具调用进行代码检索。",
	"Stream after tool rejection":                                                                   "工具拒绝后继续流式传输",
	" streaming will continue after the tool call is rejected.":                                     " 拒绝工具调用后流式传输将继续。",
	"Settings":              "设置",
	"Open in browser":       "在浏览器中打开",
	"Save Chat as Markdown": "将聊天保存为 Markdown",
	"Today":                 "今天",
	"This Week":             "本周",
	"This Month":            "本月",
	"Older":                 "更早",
	"Clear sessions":        "清除会话",
	"Are you sure you want to permanently delete all chat sessions, including the current chat session?": "确定要永久删除所有聊天会话（包括当前会话）吗？",
	"Search past sessions":                       "搜索历史会话",
	"must be string":                             "必须是字符串",
	"must NOT have additional properties":        "不得包含额外属性",
	"must be object":                             "必须是对象",
	"must be equal to one of the allowed values": "必须等于允许值之一",
	"must be integer":                            "必须是整数",
	"must be >= 1":                               "必须 >= 1",
	"must be boolean":                            "必须是布尔值",
	"must be array":                              "必须是数组",
	"must match exactly one schema in oneOf":     "必须完全匹配 oneOf 中的一个模式",
	"must be >= 0":                               "必须 >= 0",
	"More":                                       "更多",
	"Input example":                              "输入示例",
	"Success":                                    "成功",
	"Warning":                                    "警告",
	"Default":                                    "默认",
	"CHANGED:":                                   "已更改：",
	"ADDED:":                                     "已添加：",
	"DELETED:":                                   "已删除：",
	"ARRAY:":                                     "数组：",
	"Open configuration":                         "打开配置",
	"Automatic":                                  "自动",
	"Ask First":                                  "询问",
	"Excluded":                                   "禁用",
	"Disable model reasoning":                    "启用深度思考",
	"Enable model reasoning":                     "关闭深度思考",
}

// rawTranslationsContinue 全局替换规则（直接替换，不加引号）
var rawTranslationsContinue = map[string]string{
	"\"read_file\"":                                "\"读取文件\"",
	"\"create_new_file\"":                          "\"创建新文件\"",
	"\"run_terminal_command\"":                     "\"执行终端命令\"",
	"\"file_glob_search\"":                         "\"文件通配符搜索\"",
	"\"view_diff\"":                                "\"查看差异\"",
	"\"read_currently_open_file\"":                 "\"读取当前打开的文件\"",
	"\"create_rule_block\"":                        "\"创建规则块\"",
	"\"fetch_url_content\"":                        "\"获取 URL 内容\"",
	"\"request_rule\"":                             "\"请求规则\"",
	"\"read_skill\"":                               "\"读取skill\"",
	"\"multi_edit\"":                               "\"批量编辑\"",
	"\"grep_search\"":                              "\"Grep 搜索\"",
	"\"Learn how to\"":                             "\"了解如何\"",
	"\"Running\"":                                  "\"运行中\"",
	" to toggle config":                            " 以切换配置",
	" to toggle model":                             " 以切换模型",
	" for next mode":                               " 以切换至下一模式",
	"Used in Chat, Plan, Agent mode":               "用于对话、规划及 Agent 模式",
	"Used in inline code completions as you type":  "用于输入时的行内代码补全",
	"Used to transform a selected section of code": "用于转换选中的代码段",
	"Use this tool if you need to view the contents of an existing file.":              "如需查看现有文件的内容，请使用此工具。",
	"Create a new file. Only use this when a file doesn't exist and should be created": "创建新文件。仅在文件不存在且需要创建时使用此工具。",
	"Search for files recursively in the project using glob patterns. Supports ** for recursive directory search. Will not show many build, cache, secrets dirs/files (can use ls tool instead). Output may be truncated; use targeted patterns": "使用 glob 通配符在项目中递归搜索文件。支持使用 ** 进行目录递归。会自动忽略大多数构建、缓存及密钥类文件与目录（此类文件请改用 ls 工具查看）。搜索结果可能会被截断；请尽量使用更精确的搜索模式。",
	"View the current diff of working changes": "查看当前变更差异",
	"Read the currently open file in the IDE. If the user seems to be referring to a file that you can't see, or is requesting an action on content that seems missing, try using this tool.": "读取 IDE 中当前打开的文件。如果用户提到的文件您找不到，或者请求操作的内容似乎缺失，请尝试使用此工具。",
	"Ask anything, '@' to add context":                                        "请输入问题，按 '@' 添加上下文",
	"Error: ${(r==null?void 0:r.title)||\"Model\"} - ${c||\"Unknown error\"}": "Error: ${(r==null?void 0:r.title)||\"Model\"} - ${c||\"未知错误\"}",
}

// applyContinueTranslations 应用 Continue 扩展的翻译规则
func applyContinueTranslations(content string) (string, TranslateStats) {
	stats := TranslateStats{}

	// 1. 带引号的翻译（匹配 "key", 'key', `key` 三种格式）
	for k, v := range quotedTranslationsContinue {
		// "key" -> "value"
		oldDouble := "\"" + k + "\""
		newDouble := "\"" + v + "\""
		if strings.Contains(content, oldDouble) {
			content = strings.ReplaceAll(content, oldDouble, newDouble)
			stats.NormalCount++
		}

		// 'key' -> 'value'
		oldSingle := "'" + k + "'"
		newSingle := "'" + v + "'"
		if strings.Contains(content, oldSingle) {
			content = strings.ReplaceAll(content, oldSingle, newSingle)
			stats.NormalCount++
		}

		// `key` -> `value`
		oldBacktick := "`" + k + "`"
		newBacktick := "`" + v + "`"
		if strings.Contains(content, oldBacktick) {
			content = strings.ReplaceAll(content, oldBacktick, newBacktick)
			stats.NormalCount++
		}
	}

	// 2. 全局替换
	for k, v := range rawTranslationsContinue {
		if strings.Contains(content, k) {
			content = strings.ReplaceAll(content, k, v)
			stats.TemplateCount++
		}
	}

	return content, stats
}
